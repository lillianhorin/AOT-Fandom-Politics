---
title: "Survey_Data_Visualization"
author: "Lillian Horin (for Jarek Azim)"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction

This code will visualize the data from the survey conducted by Jarek Azim. One thing to note here is that the survey was conducted on QuestionPro, whose export function is not friendly for R analysis. This makes digging deeper in the analysis difficult (e.g. seeing whether results stratified by nationality). QuestionPro better exported just the final data, but since that is very easy to just manually type here, that is what I will be doing.

# Data Import

First, loading in the libraries for organization and data visualization.

```{r Import-libraries, echo=T, message=FALSE, warning=FALSE}
# Load libraries
library(tidyverse)
library(RColorBrewer)
```

These next codes will be loading in the survey data. 

```{r Social-Impact}
# Create dataset
social_impact_data <- tibble(  
	Answer = c("Yes", "No", "Probably", "I've Never Noticed"), 
	Proportion = c(0.4932, 0.0685, 0.3699, 0.0685)
)

social_impact_data


```

```{r Backlash}
# Create dataset
backlash_data <- tibble(Type = c("Historical Depictions", 
                                 "Historical Depictions", 
                                 "Historical Depictions", 
                                 "Historical Depictions", 
                                 "Historical Depictions", 
                                 "Political Insensitivity",
                                 "Political Insensitivity",
                                 "Political Insensitivity",
                                 "Political Insensitivity",
                                 "Political Insensitivity",
                                 "International Satire",
                                 "International Satire",
                                 "International Satire",
                                 "International Satire",
                                 "International Satire","Discrimination","Discrimination","Discrimination","Discrimination","Discrimination","Other","Other","Other","Other","Other"),
                        Answer = c("Often", "Somewhat Often", "Neutral", "Somewhat Rare", "Rare","Often", "Somewhat Often", "Neutral", "Somewhat Rare", "Rare","Often", "Somewhat Often", "Neutral", "Somewhat Rare", "Rare","Often", "Somewhat Often", "Neutral", "Somewhat Rare", "Rare","Often", "Somewhat Often", "Neutral", "Somewhat Rare", "Rare"),
                        Proportion = c(0.2958, 0.4225,0.1268,0.1127,0.0423,0.4143,0.3857,0.1143,0.0571,0.0286,0.1449,0.2609,0.3913,0.1594,0.0435,0.4722,0.4167,0.056,0.056,0.00,0.1944,0.1389,0.6389,0.278,0.00)
)


```


# Data Preparation

In order to visualize the graphs in a particular order, the data `levels` will be explicitly defined.

```{r Factor-levels, echo=T, message=F}
# Define order of answers that will be visualized
social_impact_data$Answer <- social_impact_data$Answer %>%
  factor(levels = c("Yes", "No", "Probably", "I've Never Noticed"))

class(social_impact_data$Answer)

backlash_data$Answer <- backlash_data$Answer %>%
  factor(levels = c("Often", "Somewhat Often", "Neutral", "Somewhat Rare", "Rare"))

class(backlash_data$Answer)

backlash_data$Type <- backlash_data$Type %>%
  factor(levels = c("Historical Depictions", "Political Insensitivity", "International Satire", "Discrimination", "Other"))

class(backlash_data$Type)

```



# Visualize Data

Now time to visualize the data. For some reason, font changes aren't working here.

```{r Social-Impact-Graph", warnings=FALSE}
social_impact_graph <- social_impact_data %>%
  ggplot(aes(x = Answer, y = Proportion, fill=Answer)) + 
  geom_bar(stat="identity", show.legend = FALSE) + 
  ylab("% Respondents") + 
  scale_y_continuous(labels = scales::percent, limits=c(0,1))+
  geom_text(aes(label=scales::percent(Proportion), vjust=-0.3)) +
  theme(axis.title.x = element_blank())

```

```{r}
social_impact_graph

```


```{r Backlash-Graph}

backlash_data %>%
  ggplot(aes(x= Answer, Group=Type)) + 
  geom_bar(show.legend = FALSE, aes(y = Proportion, fill = factor(Type)), stat="identity") + 
  geom_text(aes( label = scales::percent(Proportion),y= Proportion ), stat= "identity", vjust = -.5, size = 3) +
  labs(y = "% Respondents", fill="Type") +
  facet_grid(~Type) +
  scale_y_continuous(labels = scales::percent,limits=c(0,1)) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle = 45, hjust = 1))

```


---
```{r Session-info}
sessionInfo()
```

